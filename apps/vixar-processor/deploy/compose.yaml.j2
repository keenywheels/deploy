services:
  {{ app.name }}:
    image: {{ app.image.name }}:{{ app.image.tag }}
    container_name: {{ app.name }}
    restart: always
    mem_limit: 512m
    cpus: 0.5
    volumes:
      - /opt/apps/{{ app.name }}/configs/processor.yaml:/processor/configs/processor.yaml:ro
      - /var/log/{{ app.name }}:/{{ app.name }}/log
    command: ./processor --config /processor/configs/processor.yaml
    networks:
      - {{ app.name }}-net
      - kafka-net
      - sntmnt-net
      - postgres-net

networks:
  {{ app.name }}-net:
    external: true
  kafka-net:
    external: true
  sntmnt-net:
    external: true
  postgres-net:
    external: true
